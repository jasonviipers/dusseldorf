apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: dusseldorfkv-user-msi
  namespace: httplistener
spec:
  provider: azure
  secretObjects:
  - secretName: dssldrf-dataplane-connstr
    type: Opaque
    data:
    - objectName: dssldrf-dataplane-connstr
      key:  dssldrf-dataplane-connstr
  - secretName: dssldrf-canary-cert
    type: "kubernetes.io/tls"
    data:
    - objectName: dssldrf-test-cert
      key:  tls.key
    - objectName: dssldrf-test-cert
      key:  tls.crt
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "true"          
    userAssignedIdentityID: fc6ff5cb-be82-4c13-a833-149a80ad3db4
    keyvaultName: dssldrf-test        
    cloudName: "AzurePublicCloud"                         
    objects:  |
      array:
        - |
          objectName: dssldrf-dataplane-connstr
          objectType: secret          
          objectVersion: ""
        - |
          objectName: dssldrf-test-cert
          objectType: secret         
          objectVersion: ""
    tenantId: 72f988bf-86f1-41af-91ab-2d7cd011db47 